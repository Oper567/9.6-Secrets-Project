<%- include('partials/header') %>

<style>
  :root {
    --admin-gradient: linear-gradient(135deg, #1e5128 0%, #4e944f 100%);
    --glass-bg: rgba(255, 255, 255, 0.9);
  }

  .admin-header {
    background: var(--admin-gradient);
    color: white;
    padding: 2rem 0;
    margin-bottom: 2rem;
    border-radius: 0 0 20px 20px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.1);
  }

  .stat-card {
    background: white;
    border: none;
    border-radius: 15px;
    transition: transform 0.3s ease;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
  }

  .stat-card:hover {
    transform: translateY(-5px);
  }

  .icon-shape {
    width: 60px;
    height: 60px;
    background: #e8f5e9;
    color: #2e7d32;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 12px;
    font-size: 1.5rem;
  }

  .table-container {
    background: white;
    padding: 1.5rem;
    border-radius: 20px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.05);
  }

  .badge-user { background-color: #f0fdf4; color: #166534; }
  .badge-post { background-color: #eff6ff; color: #1e40af; }
</style>

<div class="admin-header text-center">
  <div class="container">
    <h1 class="display-5 fw-bold">Elder's Chamber ðŸŒ´</h1>
    <p class="lead">Managing the growth and peace of Apugo Village</p>
  </div>
</div>

<div class="container mb-5">
  <div class="row g-4 mb-5">
    <div class="col-md-4">
      <div class="card stat-card p-3">
        <div class="d-flex align-items-center">
          <div class="icon-shape me-3">
            <i class="fas fa-users"></i>
          </div>
          <div>
            <h6 class="text-muted mb-0">Total Villagers</h6>
            <h3 class="fw-bold mb-0"><%= stats.users %></h3>
          </div>
        </div>
      </div>
    </div>
    
    <div class="col-md-4">
      <div class="card stat-card p-3">
        <div class="d-flex align-items-center">
          <div class="icon-shape me-3" style="background: #fff7ed; color: #9a3412;">
            <i class="fas fa-paper-plane"></i>
          </div>
          <div>
            <h6 class="text-muted mb-0">Active Posts</h6>
            <h3 class="fw-bold mb-0"><%= stats.posts %></h3>
          </div>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="card stat-card p-3">
        <div class="d-flex align-items-center">
          <div class="icon-shape me-3" style="background: #fdf2f8; color: #9d174d;">
            <i class="fas fa-shield-alt"></i>
          </div>
          <div>
            <h6 class="text-muted mb-0">System Status</h6>
            <h3 class="fw-bold mb-0 text-success">Secure</h3>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="table-container">
    <div class="d-flex justify-content-between align-items-center mb-4">
      <h4 class="fw-bold mb-0">Recent Activity Log</h4>
      <div class="dropdown">
        <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
          Filter Actions
        </button>
        <ul class="dropdown-menu">
          <li><a class="dropdown-item" href="#">Posts Only</a></li>
          <li><a class="dropdown-item" href="#">User Flags</a></li>
        </ul>
      </div>
    </div>

    <div class="table-responsive">
      <table class="table table-hover align-middle">
        <thead class="table-light">
          <tr>
            <th>Timestamp</th>
            <th>Author ID</th>
            <th>Content Preview</th>
            <th>Type</th>
            <th class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          <% recentPosts.forEach(post => { %>
            <tr>
              <td class="small text-muted">
                <%= new Date(post.created_at).toLocaleDateString() %>
              </td>
              <td>
                <span class="fw-medium">#<%= post.created_by %></span>
              </td>
              <td class="text-wrap" style="max-width: 300px;">
                <%= post.description.substring(0, 60) %>...
              </td>
              <td>
                <span class="badge badge-post">Post</span>
              </td>
              <td class="text-end">
                <button class="btn btn-light btn-sm me-2" title="View Detail">
                  <i class="fas fa-eye"></i>
                </button>
                <form action="/event/<%= post.id %>/delete" method="POST" style="display:inline;">
                    <button class="btn btn-outline-danger btn-sm" onclick="return confirm('Archive this post?')">
                      <i class="fas fa-trash-alt"></i>
                    </button>
                </form>
              </td>
            </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>
</div>

<%- include('partials/footer') %>